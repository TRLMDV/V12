type Translations = Record<string, string>;
export type AppLanguage = 'en' | 'ru';

// Base English translations (from current app)
const BASE_EN: Translations = {
  backupRestore: 'Backup & Restore', backupData: 'Backup Data', restoreData: 'Restore Data', restoreWarning: 'This will overwrite all current data. Are you sure you want to proceed?', restoreSuccess: 'Data restored successfully. The application will now reload.', restoreError: 'Invalid backup file.',
  theme: 'Theme', light: 'Light', dark: 'Dark', companyDetails: 'Company Details', companyName: 'Company Name', companyLogo: 'Company Logo', changeLogo: 'Change File', saveCompanyDetails: 'Save Company Details', success: 'Success', detailsUpdated: 'Company details updated.',
  dashboard: 'Dashboard', products: 'Products', purchaseOrders: 'Purchase Orders', sellOrders: 'Sell Orders', suppliers: 'Suppliers', customers: 'Customers', incomingPayments: 'Incoming Payments', outgoingPayments: 'Outgoing Payments', warehouses: 'Warehouses', productMovement: 'Product Movement', utilization: 'Utilization', finance: 'Finance', profitability: 'Profitability', dataImportExport: 'Data Import/Export',
  settings: 'Settings',
  totalRevenueShipped: 'Total Revenue (Shipped)', cogs: 'Cost of Goods Sold (COGS)', grossProfitShipped: 'Gross Profit (Shipped)', liveCurrencyRates: 'Live Currency Rates (to {mainCurrency})', overduePaymentAlerts: 'Overdue Payment Alerts', orderId: 'Order ID', customer: 'Customer', orderDate: 'Order Date', daysOverdue: 'Days Overdue', amountDue: 'Amount Due', noOverduePayments: 'No overdue payments. All accounts are settled!', lowStockAlerts: 'Low Stock Alerts', product: 'Product', sku: 'SKU', totalStock: 'Total Stock', minStock: 'Min. Stock', noLowStockProducts: 'No products are low on stock. Great job!', addProduct: 'Add Product', image: 'Image', name: 'Name', category: 'Category', avgLandedCost: 'Avg. Landed Cost',
  edit: 'Edit', delete: 'Delete', noItemsFound: 'No items found.', editProduct: 'Edit Product', createProduct: 'Create Product', productName: 'Product Name', productImage: 'Product Image', chooseFile: 'Choose File', minimumStockLevel: 'Minimum Stock Level', saveProduct: 'Save Product', editSellOrder: 'Edit Sell Order', createSellOrder: 'Create Sell Order', editPurchaseOrder: 'Edit Purchase Order', createPurchaseOrder: 'Create PurchaseOrder', supplier: 'Supplier', sourceWarehouse: 'Source Warehouse', destinationWarehouse: 'Destination Warehouse', status: 'Status', draft: 'Draft', confirmed: 'Confirmed', ordered: 'Ordered', shipped: 'Shipped', received: 'Received', orderItems: 'Order Items', selectProduct: 'Select Product', qty: 'Qty', price: 'Price', addItem: 'Add Item', exchangeRateToAZN: 'Exchange Rate to AZN', exchangeRatePlaceholder: 'e.g., 2.00 for EUR', exchangeRateHelpText: 'Enter the value of 1 unit of the foreign currency in AZN.', fees: 'Fees', vatPercent: 'VAT (%)', total: 'Total', saveOrder: 'Save Order', stockError: 'Stock Error', notEnoughStock: 'Not enough stock for', available: 'Available', requested: 'Requested', language: 'Language', addWarehouse: 'Add Warehouse', productsInThisWarehouse: 'Products in This Warehouse', noProductsStored: 'No products currently stored here.', addPO: 'Add PO', addSO: 'Add SO', filterByWarehouse: 'Filter by Warehouse:', allWarehouses: 'All Warehouses', noOrdersForWarehouse: 'No orders found for this warehouse.', orderStatus: 'Order Status', paymentStatus: 'Payment Status', paid: 'Paid', partiallyPaid: 'Partially Paid', unpaid: 'Unpaid', addPayment: 'Add Payment', paymentId: 'Payment ID', linkedOrder: 'Linked Order', amount: 'Amount', method: 'Method', newMovement: 'New Movement', from: 'From', to: 'To', totalItems: 'Total Items', view: 'View', detailsForMovement: 'Details for Movement', financeTitle: 'Finance - Profit & Loss', period: 'Period:', allTime: 'All Time', thisYear: 'This Year', thisMonth: 'This Month', thisWeek: 'This Week', today: 'This Day', keyMetrics: 'Key Metrics', totalRevenue: 'Total Revenue', grossProfit: 'Gross Profit', totalVatCollected: 'Total VAT Collected', cashFlow: 'Cash Flow', totalIncomingPayments: 'Total Incoming Payments', totalOutgoingPayments: 'Total Outgoing Payments', netCashFlow: 'Net Cash Flow', profitabilityAnalysis: 'Profitability Analysis', startDate: 'Start Date', endDate: 'End Date', filter: 'Filter', salesPercentage: 'Sales Percentage (by Qty)', daysInStock: 'Days in Stock', totalSales: 'Total Sales (Markup-Based)', cleanProfit: 'Clean Profit (Markup-Based)',
  currencyRatesSettings: 'Currency Rates (to {mainCurrency})', toCurrency: 'to {targetCurrency}', saveCurrencyRates: 'Save Currency Rates', ratesUpdated: 'Currency rates updated.', invalidRates: 'Please enter valid numbers for currency rates.',
  productsSubtotal: 'Products Subtotal',
  qtySold: 'Qty Sold',
  manualExpense: 'Manual Expense / Unlinked Payment',
  landedCostPlusMarkup: 'Avg LC + Markup (Excl VAT)',
  landedCostPlusMarkupPlusVat: 'Avg LC + Markup + VAT (Incl VAT)',
  totals: 'Totals',
  orderSummary: 'Order Summary',
  orderFees: 'Order Fees',
  feeType: 'Fee Type',
  order: 'Order',
  exportedSuccessfully: 'exported successfully',
  exportError: 'Export Error',
  selectCategory: 'Select Category',
  filterByCategory: 'Filter by Category',
  allCategories: 'All Categories',
  bank: 'Bank',
  bankAccount: 'Bank Account',
  setInitialCapital: 'Set Initial Capital',
  initialCapital: 'Initial Capital',
  currentBalance: 'Current Balance',
  transactionHistory: 'Transaction History',
  date: 'Date',
  description: 'Description',
  incoming: 'Incoming',
  outgoing: 'Outgoing',
  balance: 'Balance',
  noTransactionsFound: 'No transactions found for the selected period.',
  bankAccounts: 'Bank Accounts',
  yourBankAccounts: 'Your Bank Accounts',
  addBankAccount: 'Add Bank Account',
  editBankAccount: 'Edit Bank Account',
  deleteBankAccount: 'Delete Bank Account',
  bankAccountName: 'Account Name',
  selectCurrency: 'Select Currency',
  saveBankAccount: 'Save Bank Account',
  noBankAccountsFound: 'No bank accounts found. Add one to start tracking your finances!',
  bankAccountNameRequired: 'Bank account name is required.',
  bankAccountCurrencyRequired: 'Bank account currency is required.',
  invalidInitialBalance: 'Initial balance must be a valid number.',
  deleteBankAccountWarning: 'Are you sure you want to delete the bank account "{accountName}"? This action cannot be undone.',
  selectBankAccount: 'Select Bank Account',
  noBankAccountsAvailable: 'No bank accounts available. Please create one first.',
  depositMoney: 'Deposit Money',
  withdrawMoney: 'Withdraw Money',
  withdrawal: 'Withdrawal',
  pleaseAddBankAccountInstruction: 'To view transactions, please add a bank account first using the "Add Bank Account" button.',
  bankAccountBalance: 'Bank Account Balance',
  creationDate: 'Creation Date',
  bankAccountCreationDateRequired: 'Bank account creation date is required.',
  utilizationOrders: 'Utilization Orders',
  addUtilizationOrder: 'Add Utilization Order',
  editUtilizationOrder: 'Edit Utilization Order',
  saveUtilizationOrder: 'Save Utilization Order',
  detailsForUtilizationOrder: 'Details for Utilization Order',
  noUtilizationOrdersFound: 'No utilization orders found.',
  utilizationOrder: 'Utilization Order',
  items: 'Items',
  cannotDeleteProductInUtilizationOrders: 'Cannot delete product because it is part of one or more utilization orders.',
  utilizationOrdersImportExportDescription: 'Import new utilization orders (items must be added manually) or export your existing utilization order records.',
  importUtilizationOrdersDescription: 'Import Utilization Orders',
  comment: 'Comment',
  orderCommentPlaceholder: 'e.g., Special delivery instructions, payment terms, internal notes',
  utilizationCommentPlaceholder: 'e.g., Damaged goods, expired products, internal use',
  noComment: 'No comment provided',
  confirm: 'Confirm',
  quickButtons: 'Quick Buttons',
  addQuickButton: 'Add Quick Button',
  editQuickButton: 'Edit Quick Button',
  deleteQuickButton: 'Delete Quick Button',
  buttonLabel: 'Button Label',
  buttonAction: 'Button Action',
  buttonSize: 'Button Size',
  buttonColor: 'Button Color',
  saveQuickButton: 'Save Quick Button',
  noQuickButtonsFound: 'No quick buttons configured. Add some to speed up your workflow!',
  quickButtonAdded: 'Quick button added successfully.',
  quickButtonUpdated: 'Quick button updated successfully.',
  quickButtonDeleted: 'Quick button deleted successfully.',
  deleteQuickButtonWarning: 'Are you sure you want to delete this quick button? This action cannot be undone.',
  selectButtonAction: 'Select Action',
  selectButtonSize: 'Select Size',
  selectButtonColor: 'Select Color',
  quickPurchaseOrderAdd: 'Quick Purchase Order Add',
  quickSellOrderAdd: 'Quick Sell Order Add',
  quickProductMovement: 'Quick Product Movement',
  quickProductAdd: 'Quick Product Add',
  quickSupplierAdd: 'Quick Supplier Add',
  quickCustomerAdd: 'Quick Customer Add',
  quickIncomingPaymentsAdd: 'Quick Incoming Payment Add',
  quickOutgoingPaymentsAdd: 'Quick Outgoing Payment Add',
  quickWarehouseAdd: 'Quick Warehouse Add',
  quickUtilization: 'Quick Utilization Order Add',
  quickBankDeposit: 'Quick Bank Deposit',
  quickBankWithdrawal: 'Quick Bank Withdrawal',
  sizeSm: 'Small',
  sizeMd: 'Medium',
  sizeLg: 'Large',
  colorBlue: 'Blue',
  colorGreen: 'Green',
  colorRed: 'Red',
  colorPurple: 'Purple',
  colorOrange: 'Orange',
  colorYellow: 'Yellow',
  colorEmerald: 'Emerald',
  colorIndigo: 'Indigo',
  colorPink: 'Pink',
  colorTeal: 'Teal',
  yes: 'Yes',
  no: 'No',
  selectWarehouseToSeeStock: 'Select warehouse to see stock',
  deleteSellOrder: 'Delete Sell Order',
  deleteSellOrderWarning: 'Are you sure you want to delete this Sell Order?',
  alsoDeleteAssociatedItems: 'This will also move the following associated items to the Recycle Bin',
  selectAll: 'Select All',
  deselectAll: 'Deselect All',
  exportTransactionsToExcel: 'Export Transactions to Excel',
  feesExchangeRateToAZN: 'Fees Exchange Rate to AZN',
  salesChart: 'Sales Chart',
  showSalesChartOnDashboard: 'Show Sales Chart on Dashboard',
  yearlySales: 'Yearly Sales',
  monthlySales: 'Monthly Sales',
  selectYear: 'Select Year',
  selectMonth: 'Select Month',
  totalSalesValue: 'Total Sales Value',
  noSalesData: 'No sales data available for the selected period.',
  salesOverview: 'Sales Overview',
  salesByMonth: 'Sales by Month',
  salesByDay: 'Sales by Day',
  previous: 'Previous',
  next: 'Next',
  jan: 'Jan', feb: 'Feb', mar: 'Mar', apr: 'Apr', may: 'May', jun: 'Jun', jul: 'Jul', aug: 'Aug', sep: 'Sep', oct: 'Oct', nov: 'Nov', dec: 'Dec',
  day: 'Day',
  singlePeriod: 'Single Period',
  allPeriods: 'All Periods',
  productTransactions: 'Product Transactions',
  productTransactionsDescription: 'List of all purchase and sales orders containing this product.',
  purchaseOrdersWithProduct: 'Purchase Orders with Product',
  purchaseOrdersWithProductDescription: 'List of purchase orders containing this product.',
  priceInOrderCurrency: 'Price (Order Currency)',
  currencyRateToMainCurrency: 'Rate (1 {orderCurrency} to {mainCurrency})',
  noPurchaseOrdersFoundForProduct: 'No purchase orders found for this product.',
  salesOrdersWithProduct: 'Sales Orders with Product',
  saleDate: 'Sale Date',
  priceExclVat: 'Price (Excl. VAT)',
  priceInclVat: 'Price (Incl. VAT)',
  noSalesOrdersFoundForProduct: 'No sales orders found for this product.',
  landedCostPerUnit: 'Landed Cost Per Unit',
  transactionId: 'Transaction ID',
  calendarAndReminders: 'Calendar & Reminders',
  addReminder: 'Add Reminder',
  editReminder: 'Edit Reminder',
  saveReminder: 'Save Reminder',
  deleteReminder: 'Delete Reminder',
  deleteReminderWarning: 'Are you sure you want to delete this reminder? This action cannot be undone.',
  noRemindersForSelectedDate: 'No reminders for the selected date.',
  selectADate: 'Select a date to view reminders.',
  message: 'Message',
  time: 'Time',
  pickADate: 'Pick a date',
  allFieldsRequired: 'All fields are required.',
  reminderAdded: 'Reminder added successfully.',
  reminderUpdated: 'Reminder updated successfully.',
  reminderDeleted: 'Reminder deleted successfully.',
  reminder: 'Reminder',
  dismiss: 'Dismiss',
  clockSettings: 'Clock Settings',
  showClockOnDashboard: 'Show Clock on Dashboard',
  calendarSettings: 'Calendar Settings',
  showCalendarOnDashboard: 'Show Calendar on Dashboard',
  enterTimeIn24HourFormat: 'Enter time in HH:mm (24-hour format)',
  invalidTimeFormat: 'Invalid time format. Please use HH:mm (e.g., 14:30).',
  selectHour: 'Select Hour',
  selectMinute: 'Select Minute',
  noMessageProvided: 'No message provided',
  hours: 'Hours',
  minutes: 'Minutes',
  seconds: 'Seconds',
  barcodeScanner: 'Barcode Scanner',
  scanBarcode: 'Scan Barcode',
  productNotFound: 'Product Not Found',
  productNotFoundDescription: 'No product found with SKU: {barcode}',
  barcodeTooShort: 'Barcode Too Short',
  barcodeTooShortDescription: 'Scanned barcode "{length}" is too short. Minimum length is {minLength}.',
  barcodeScanned: 'Barcode Scanned',
  barcodeScannedDescription: 'Product "{productName}" added to order.',
  barcode: 'Barcode',
  enterBarcode: 'Enter Barcode',
  quantityIncremented: 'quantity incremented',
  addedToOrder: 'added to order',
  found: 'found',
  productNameRequired: 'Product Name is required.',
  skuRequired: 'SKU is required.',
  duplicateSkuError: 'A product with SKU "{sku}" already exists. Please use a unique SKU.',
  usedVat: 'VAT Used',
  vatBalance: 'VAT Balance',
  vatUsedOnPayments: 'VAT used to pay expenses',
  vatBalanceOnHand: 'VAT currently on balance',
  mainCurrencySettings: 'Main Currency Settings',
  mainCurrency: 'Main Currency',
  saveMainCurrency: 'Save Main Currency',
  mainCurrencyUpdated: 'Main currency updated.',
  activeCurrenciesSelection: 'Active Currencies Selection',
  activeCurrenciesDescription: 'Select which currencies are active and can be used in the app.',
  saveActiveCurrencies: 'Save Active Currencies',
  mainCurrencyCannotBeDeactivated: 'Main currency cannot be deactivated.',
  allCurrenciesSelected: 'All currencies selected.',
  allCurrenciesDeselected: 'All currencies deselected (only main currency kept).',
  activeCurrenciesUpdated: 'Active currencies updated.',
  defaultVat: 'Default VAT (%)',
  saveDefaultVat: 'Save Default VAT',
  vatUpdated: 'Default VAT updated.',
  defaultMarkup: 'Default Markup (%)',
  saveDefaultMarkup: 'Save Default Markup',
  markupUpdated: 'Default markup updated.',
  dashboardCurrencyRates: 'Dashboard Currency Rates',
  showCurrencyRatesOnDashboard: 'Show Currency Rates on Dashboard',
  packingUnits: 'Packing Units',
  addPackingUnit: 'Add Packing Unit',
  packingUnitName: 'Packing Unit Name',
  baseUnit: 'Base Unit',
  conversionFactor: 'Conversion Factor',
  noPackingUnitsFound: 'No packing units found.',
  editPackingUnit: 'Edit Packing Unit',
  deletePackingUnit: 'Delete Packing Unit',
  deletePackingUnitWarning: 'Are you sure you want to delete this packing unit? This action cannot be undone.',
  packingUnitAdded: 'Packing unit added successfully.',
  packingUnitUpdated: 'Packing unit updated successfully.',
  packingUnitDeleted: 'Packing unit deleted successfully.',
  defaultPacking: 'Default Packing',
  searchBySku: 'Search by SKU',
  enterSku: 'Enter SKU',
  actions: 'Actions'
};

// Base Russian translations (from current app)
const BASE_RU: Translations = {
  backupRestore: 'Резервное копирование и восстановление', backupData: 'Сохранить резервную копию', restoreData: 'Восстановить данные', restoreWarning: 'Это перезапишет все текущие данные. Вы уверены, что хотите продолжить?', restoreSuccess: 'Данные успешно восстановлены. Приложение будет перезагружено.', restoreError: 'Неверный файл резервной копии.',
  theme: 'Тема', light: 'Светлая', dark: 'Тёмная', companyDetails: 'Данные компании', companyName: 'Название компании', companyLogo: 'Логотип компании', changeLogo: 'Выбрать файл', saveCompanyDetails: 'Сохранить данные компании', success: 'Успех', detailsUpdated: 'Данные компании обновлены.',
  dashboard: 'Панель', products: 'Товары', purchaseOrders: 'Закупки', sellOrders: 'Продажи', suppliers: 'Поставщики', customers: 'Клиенты', incomingPayments: 'Входящие платежи', outgoingPayments: 'Исходящие платежи', warehouses: 'Склады', productMovement: 'Перемещение товара', utilization: 'Списание', finance: 'Финансы', profitability: 'Рентабельность', dataImportExport: 'Импорт/Экспорт данных',
  settings: 'Настройки',
  totalRevenueShipped: 'Доход (Отгружено)', cogs: 'Себестоимость (COGS)', grossProfitShipped: 'Валовая прибыль (Отгружено)', liveCurrencyRates: 'Курсы валют (к {mainCurrency})', overduePaymentAlerts: 'Просроченные платежи', orderId: 'Заказ №', customer: 'Клиент', orderDate: 'Дата заказа', daysOverdue: 'Дней просрочки', amountDue: 'Сумма к оплате', noOverduePayments: 'Просроченных платежей нет!', lowStockAlerts: 'Низкие остатки', product: 'Товар', sku: 'Артикул', totalStock: 'Всего на складе', minStock: 'Мин. остаток', noLowStockProducts: 'Нет товаров с низким остатком.', addProduct: 'Добавить товар', image: 'Изображение', name: 'Название', category: 'Категория', avgLandedCost: 'Ср. себестоимость',
  edit: 'Редактировать', delete: 'Удалить', noItemsFound: 'Ничего не найдено.', editProduct: 'Редактировать товар', createProduct: 'Создать товар', productName: 'Название товара', productImage: 'Изображение товара', chooseFile: 'Выбрать файл', minimumStockLevel: 'Минимальный остаток', saveProduct: 'Сохранить товар', editSellOrder: 'Редактировать заказ на продажу', createSellOrder: 'Создать заказ на продажу', editPurchaseOrder: 'Редактировать заказ на закупку', createPurchaseOrder: 'Создать закупку', supplier: 'Поставщик', sourceWarehouse: 'Склад-источник', destinationWarehouse: 'Склад назначения', status: 'Статус', draft: 'Черновик', confirmed: 'Подтверждён', ordered: 'Заказан', shipped: 'Отгружен', received: 'Получен', orderItems: 'Позиции заказа', selectProduct: 'Выберите товар', qty: 'Кол-во', price: 'Цена', addItem: 'Добавить', exchangeRateToAZN: 'Курс к AZN', exchangeRatePlaceholder: 'например, 2.00 для EUR', exchangeRateHelpText: 'Введите значение 1 единицы валюты в AZN.', fees: 'Сборы', vatPercent: 'НДС (%)', total: 'Итого', saveOrder: 'Сохранить заказ', stockError: 'Ошибка остатков', notEnoughStock: 'Недостаточно на складе для', available: 'Доступно', requested: 'Запрошено', language: 'Язык', addWarehouse: 'Добавить склад', productsInThisWarehouse: 'Товары на складе', noProductsStored: 'На этом складе нет товаров.', addPO: 'Добавить закупку', addSO: 'Добавить продажу', filterByWarehouse: 'Фильтр по складу:', allWarehouses: 'Все склады', noOrdersForWarehouse: 'Нет заказов для этого склада.', orderStatus: 'Статус заказа', paymentStatus: 'Статус оплаты', paid: 'Оплачено', partiallyPaid: 'Частично оплачено', unpaid: 'Не оплачено', addPayment: 'Добавить платёж', paymentId: 'ID платежа', linkedOrder: 'Связанный заказ', amount: 'Сумма', method: 'Метод', newMovement: 'Новое перемещение', from: 'Из', to: 'В', totalItems: 'Всего позиций', view: 'Просмотр', detailsForMovement: 'Детали перемещения', financeTitle: 'Финансы - Прибыль и убытки', period: 'Период:', allTime: 'За всё время', thisYear: 'Этот год', thisMonth: 'Этот месяц', thisWeek: 'Эта неделя', today: 'Этот день', keyMetrics: 'Ключевые показатели', totalRevenue: 'Выручка', grossProfit: 'Валовая прибыль', totalVatCollected: 'Всего НДС начислено', cashFlow: 'Денежный поток', totalIncomingPayments: 'Всего входящих платежей', totalOutgoingPayments: 'Всего исходящих платежей', netCashFlow: 'Чистый денежный поток', profitabilityAnalysis: 'Анализ рентабельности', startDate: 'Дата начала', endDate: 'Дата окончания', filter: 'Фильтр', salesPercentage: 'Доля продаж (по кол-ву)', daysInStock: 'Дней на складе', totalSales: 'Общий объём продаж (наценка)', cleanProfit: 'Чистая прибыль (наценка)',
  currencyRatesSettings: 'Курсы валют (к {mainCurrency})', toCurrency: 'к {targetCurrency}', saveCurrencyRates: 'Сохранить курсы', ratesUpdated: 'Курсы валют обновлены.', invalidRates: 'Введите корректные значения курсов.',
  productsSubtotal: 'Промежуточный итог по товарам',
  qtySold: 'Продано (шт.)',
  manualExpense: 'Ручной расход / Несвязанный платёж',
  landedCostPlusMarkup: 'Ср. себестоимость + Наценка (без НДС)',
  landedCostPlusMarkupPlusVat: 'Ср. себестоимость + Наценка + НДС (с НДС)',
  totals: 'Итоги',
  orderSummary: 'Сводка заказа',
  orderFees: 'Сборы по заказу',
  feeType: 'Тип сбора',
  order: 'Заказ',
  exportedSuccessfully: 'успешно экспортировано',
  exportError: 'Ошибка экспорта',
  selectCategory: 'Выберите категорию',
  filterByCategory: 'Фильтр по категории',
  allCategories: 'Все категории',
  bank: 'Банк',
  bankAccount: 'Банковский счёт',
  setInitialCapital: 'Установить начальный капитал',
  initialCapital: 'Начальный капитал',
  currentBalance: 'Текущий баланс',
  transactionHistory: 'История операций',
  date: 'Дата',
  description: 'Описание',
  incoming: 'Приход',
  outgoing: 'Расход',
  balance: 'Баланс',
  noTransactionsFound: 'За выбранный период операций не найдено.',
  bankAccounts: 'Банковские счета',
  yourBankAccounts: 'Ваши банковские счета',
  addBankAccount: 'Добавить счёт',
  editBankAccount: 'Редактировать счёт',
  deleteBankAccount: 'Удалить счёт',
  bankAccountName: 'Название счёта',
  selectCurrency: 'Выберите валюту',
  saveBankAccount: 'Сохранить счёт',
  noBankAccountsFound: 'Счёта не найдены. Добавьте счёт, чтобы начать учёт финансов!',
  bankAccountNameRequired: 'Введите название счёта.',
  bankAccountCurrencyRequired: 'Выберите валюту счёта.',
  invalidInitialBalance: 'Начальный баланс должен быть числом.',
  deleteBankAccountWarning: 'Удалить банковский счёт "{accountName}"? Это действие необратимо.',
  selectBankAccount: 'Выберите банковский счёт',
  noBankAccountsAvailable: 'Нет доступных банковских счетов. Пожалуйста, создайте счёт.',
  depositMoney: 'Внести средства',
  withdrawMoney: 'Снять средства',
  withdrawal: 'Снятие',
  pleaseAddBankAccountInstruction: 'Чтобы просмотреть операции, сначала добавьте банковский счёт кнопкой «Добавить счёт».',
  bankAccountBalance: 'Баланс счёта',
  creationDate: 'Дата создания',
  bankAccountCreationDateRequired: 'Требуется дата создания счёта.',
  utilizationOrders: 'Списания',
  addUtilizationOrder: 'Добавить списание',
  editUtilizationOrder: 'Редактировать списание',
  saveUtilizationOrder: 'Сохранить списание',
  detailsForUtilizationOrder: 'Детали списания',
  noUtilizationOrdersFound: 'Списаний не найдено.',
  utilizationOrder: 'Списание',
  items: 'Позиции',
  cannotDeleteProductInUtilizationOrders: 'Нельзя удалить товар, он используется в одном или нескольких списаниях.',
  utilizationOrdersImportExportDescription: 'Импортируйте новые списания (позиции добавляются вручную) или экспортируйте существующие записи.',
  importUtilizationOrdersDescription: 'Импорт списаний',
  comment: 'Комментарий',
  orderCommentPlaceholder: 'например, условия оплаты, внутренние заметки',
  utilizationCommentPlaceholder: 'например, повреждённый товар, внутреннее использование',
  noComment: 'Комментарий отсутствует',
  confirm: 'Подтвердить',
  quickButtons: 'Быстрые кнопки',
  addQuickButton: 'Добавить кнопку',
  editQuickButton: 'Редактировать кнопку',
  deleteQuickButton: 'Удалить кнопку',
  buttonLabel: 'Надпись на кнопке',
  buttonAction: 'Действие кнопки',
  buttonSize: 'Размер кнопки',
  buttonColor: 'Цвет кнопки',
  saveQuickButton: 'Сохранить кнопку',
  noQuickButtonsFound: 'Быстрые кнопки не настроены. Добавьте для ускорения работы!',
  quickButtonAdded: 'Кнопка успешно добавлена.',
  quickButtonUpdated: 'Кнопка успешно обновлена.',
  quickButtonDeleted: 'Кнопка успешно удалена.',
  deleteQuickButtonWarning: 'Удалить эту кнопку? Это действие необратимо.',
  selectButtonAction: 'Выберите действие',
  selectButtonSize: 'Выберите размер',
  selectButtonColor: 'Выберите цвет',
  quickPurchaseOrderAdd: 'Быстрое создание закупки',
  quickSellOrderAdd: 'Быстрое создание продажи',
  quickProductMovement: 'Быстрое перемещение',
  quickProductAdd: 'Быстрое добавление товара',
  quickSupplierAdd: 'Быстрое добавление поставщика',
  quickCustomerAdd: 'Быстрое добавление клиента',
  quickIncomingPaymentsAdd: 'Быстрый входящий платёж',
  quickOutgoingPaymentsAdd: 'Быстрый исходящий платёж',
  quickWarehouseAdd: 'Быстрое добавление склада',
  quickUtilization: 'Быстрое списание',
  quickBankDeposit: 'Быстрый депозит',
  quickBankWithdrawal: 'Быстрое снятие',
  sizeSm: 'Маленький',
  sizeMd: 'Средний',
  sizeLg: 'Большой',
  colorBlue: 'Синий',
  colorGreen: 'Зелёный',
  colorRed: 'Красный',
  colorPurple: 'Фиолетовый',
  colorOrange: 'Оранжевый',
  colorYellow: 'Жёлтый',
  colorEmerald: 'Изумрудный',
  colorIndigo: 'Индиго',
  colorPink: 'Розовый',
  colorTeal: 'Бирюзовый',
  yes: 'Да',
  no: 'Нет',
  selectWarehouseToSeeStock: 'Выберите склад, чтобы увидеть остатки',
  deleteSellOrder: 'Удалить заказ на продажу',
  deleteSellOrderWarning: 'Удалить этот заказ на продажу?',
  alsoDeleteAssociatedItems: 'Это также переместит следующие связанные элементы в корзину',
  selectAll: 'Выбрать все',
  deselectAll: 'Снять выделение',
  exportTransactionsToExcel: 'Экспортировать в Excel',
  feesExchangeRateToAZN: 'Курс сборов к AZN',
  salesChart: 'Диаграмма продаж',
  showSalesChartOnDashboard: 'Показывать диаграмму продаж на панели',
  yearlySales: 'Годовые продажи',
  monthlySales: 'Месячные продажи',
  selectYear: 'Выберите год',
  selectMonth: 'Выберите месяц',
  totalSalesValue: 'Объём продаж',
  noSalesData: 'Нет данных за выбранный период.',
  salesOverview: 'Обзор продаж',
  salesByMonth: 'Продажи по месяцам',
  salesByDay: 'Продажи по дням',
  previous: 'Назад',
  next: 'Далее',
  jan: 'Янв', feb: 'Фев', mar: 'Мар', apr: 'Апр', may: 'Май', jun: 'Июн', jul: 'Июл', aug: 'Авг', sep: 'Сен', oct: 'Окт', nov: 'Ноя', dec: 'Дек',
  day: 'День',
  singlePeriod: 'Один период',
  allPeriods: 'Все периоды',
  productTransactions: 'Операции по товару',
  productTransactionsDescription: 'Список всех закупок и продаж с этим товаром.',
  purchaseOrdersWithProduct: 'Закупки с товаром',
  purchaseOrdersWithProductDescription: 'Список закупок, содержащих этот товар.',
  priceInOrderCurrency: 'Цена (валюта заказа)',
  currencyRateToMainCurrency: 'Курс (1 {orderCurrency} к {mainCurrency})',
  noPurchaseOrdersFoundForProduct: 'Закупок с этим товаром не найдено.',
  salesOrdersWithProduct: 'Продажи с товаром',
  saleDate: 'Дата продажи',
  priceExclVat: 'Цена (без НДС)',
  priceInclVat: 'Цена (с НДС)',
  noSalesOrdersFoundForProduct: 'Продаж с этим товаром не найдено.',
  landedCostPerUnit: 'Себестоимость за единицу',
  transactionId: 'ID операции',
  calendarAndReminders: 'Календарь и напоминания',
  addReminder: 'Добавить напоминание',
  editReminder: 'Редактировать напоминание',
  saveReminder: 'Сохранить напоминание',
  deleteReminder: 'Удалить напоминание',
  deleteReminderWarning: 'Удалить это напоминание? Это действие необратимо.',
  noRemindersForSelectedDate: 'Нет напоминаний на выбранную дату.',
  selectADate: 'Выберите дату для просмотра напоминаний.',
  message: 'Сообщение',
  time: 'Время',
  pickADate: 'Выберите дату',
  allFieldsRequired: 'Все поля обязательны.',
  reminderAdded: 'Напоминание добавлено.',
  reminderUpdated: 'Напоминание обновлено.',
  reminderDeleted: 'Напоминание удалено.',
  reminder: 'Напоминание',
  dismiss: 'Закрыть',
  clockSettings: 'Настройки часов',
  showClockOnDashboard: 'Показывать часы на панели',
  calendarSettings: 'Настройки календаря',
  showCalendarOnDashboard: 'Показывать календарь на панели',
  enterTimeIn24HourFormat: 'Введите время в формате ЧЧ:мм (24 часа)',
  invalidTimeFormat: 'Неверный формат времени. Используйте ЧЧ:мм (например, 14:30).',
  selectHour: 'Выберите час',
  selectMinute: 'Выберите минуту',
  noMessageProvided: 'Сообщение не указано',
  hours: 'Часы',
  minutes: 'Минуты',
  seconds: 'Секунды',
  barcodeScanner: 'Сканер штрихкода',
  scanBarcode: 'Сканировать штрихкод',
  productNotFound: 'Товар не найден',
  productNotFoundDescription: 'Не найден товар со SKU: {barcode}',
  barcodeTooShort: 'Слишком короткий штрихкод',
  barcodeTooShortDescription: 'Сканированный штрихкод длиной "{length}" слишком короткий. Минимальная длина {minLength}.',
  barcodeScanned: 'Штрихкод отсканирован',
  barcodeScannedDescription: 'Товар "{productName}" добавлен в заказ.',
  barcode: 'Штрихкод',
  enterBarcode: 'Введите штрихкод',
  quantityIncremented: 'количество увеличено',
  addedToOrder: 'добавлено в заказ',
  found: 'найден',
  productNameRequired: 'Введите название товара.',
  skuRequired: 'Введите SKU.',
  duplicateSkuError: 'Товар со SKU "{sku}" уже существует. Используйте уникальный SKU.',
  usedVat: 'Использовано НДС',
  vatBalance: 'Баланс НДС',
  vatUsedOnPayments: 'НДС, использованный для оплаты расходов',
  vatBalanceOnHand: 'Текущий остаток НДС',
  mainCurrencySettings: 'Настройки основной валюты',
  mainCurrency: 'Основная валюта',
  saveMainCurrency: 'Сохранить основную валюту',
  mainCurrencyUpdated: 'Основная валюта обновлена.',
  activeCurrenciesSelection: 'Выбор активных валют',
  activeCurrenciesDescription: 'Выберите, какие валюты активны и могут использоваться в приложении.',
  saveActiveCurrencies: 'Сохранить активные валюты',
  mainCurrencyCannotBeDeactivated: 'Нельзя отключить основную валюту.',
  allCurrenciesSelected: 'Выбраны все валюты.',
  allCurrenciesDeselected: 'Все валюты сняты (оставлена только основная).',
  activeCurrenciesUpdated: 'Список активных валют обновлён.',
  defaultVat: 'НДС по умолчанию (%)',
  saveDefaultVat: 'Сохранить НДС по умолчанию',
  vatUpdated: 'НДС по умолчанию обновлён.',
  defaultMarkup: 'Наценка по умолчанию (%)',
  saveDefaultMarkup: 'Сохранить наценку по умолчанию',
  markupUpdated: 'Наценка по умолчанию обновлена.',
  dashboardCurrencyRates: 'Курсы валют на панели',
  showCurrencyRatesOnDashboard: 'Показывать курсы валют на панели',
  packingUnits: 'Единицы упаковки',
  addPackingUnit: 'Добавить единицу упаковки',
  packingUnitName: 'Название единицы упаковки',
  baseUnit: 'Базовая единица',
  conversionFactor: 'Коэффициент преобразования',
  noPackingUnitsFound: 'Единицы упаковки не найдены.',
  editPackingUnit: 'Редактировать единицу упаковки',
  deletePackingUnit: 'Удалить единицу упаковки',
  deletePackingUnitWarning: 'Удалить эту единицу упаковки? Это действие необратимо.',
  packingUnitAdded: 'Единица упаковки успешно добавлена.',
  packingUnitUpdated: 'Единица упаковки успешно обновлена.',
  packingUnitDeleted: 'Единица упаковки успешно удалена.',
  defaultPacking: 'Упаковка по умолчанию',
  searchBySku: 'Поиск по артикулу',
  enterSku: 'Введите артикул',
  actions: 'действие'
};

// Extra keys used across the app that were missing in the original base sets
Object.assign(BASE_EN, {
  noDot: 'No.',
  na: 'N/A',
  none: 'None',
  warehouse: 'Warehouse',
  fromWarehouse: 'From Warehouse',
  customerName: 'Customer Name',
  contactPerson: 'Contact Person',
  email: 'Email',
  phone: 'Phone',
  defaultWarehouse: 'Default Warehouse',
  addCustomer: 'Add Customer',
  editCustomer: 'Edit Customer',
  createCustomer: 'Create Customer',
  detailsForOrder: 'Details for Order',
  allProducts: 'All Products',
  searchProductBySku: 'Search product by SKU',
  noProductFound: 'No product found.',
  piece: 'Piece',
  exclVat: 'Excl. VAT',
  inclVat: 'Incl. VAT',
  partiallypaid: 'Partially Paid',
  revenueExVat: 'Revenue (Excl. VAT)',
  cogsTotal: 'COGS Total',
  costOfGoodsSold: 'Cost of Goods Sold',
  grossProfitTotal: 'Gross Profit Total',
  vatCollectedFromSales: 'VAT collected from sales',
  enableChart: 'Enable Chart',
  salesChartDisabledMessage: 'Sales chart is currently disabled in Settings.',
  unknownCustomer: 'Unknown Customer',
});

Object.assign(BASE_RU, {
  noDot: '№',
  na: 'нет данных',
  none: 'Нет',
  warehouse: 'Склад',
  fromWarehouse: 'Из склада',
  customerName: 'Имя клиента',
  contactPerson: 'Контактное лицо',
  email: 'Эл. почта',
  phone: 'Телефон',
  defaultWarehouse: 'Склад по умолчанию',
  addCustomer: 'Добавить клиента',
  editCustomer: 'Редактировать клиента',
  createCustomer: 'Создать клиента',
  detailsForOrder: 'Детали заказа',
  allProducts: 'Все товары',
  searchProductBySku: 'Поиск товара по артикулу',
  noProductFound: 'Товар не найден.',
  piece: 'шт.',
  exclVat: 'без НДС',
  inclVat: 'с НДС',
  partiallypaid: 'Частично оплачено',
  revenueExVat: 'Выручка (без НДС)',
  cogsTotal: 'Итого себестоимость',
  costOfGoodsSold: 'Себестоимость проданных товаров',
  grossProfitTotal: 'Итого валовая прибыль',
  vatCollectedFromSales: 'НДС, начисленный с продаж',
  enableChart: 'Включить диаграмму',
  salesChartDisabledMessage: 'Диаграмма продаж сейчас отключена в настройках.',
  unknownCustomer: 'Неизвестный клиент',
});

// Modular i18n class
class I18n {
  private dictionaries: Record<AppLanguage, Translations>;
  private currentLang: AppLanguage;
  private loaders: Record<string, () => Promise<{ default?: Translations } | Translations>> = {};

  constructor() {
    this.dictionaries = {
      en: { ...BASE_EN },
      ru: { ...BASE_RU }
    };
    this.currentLang =
      (typeof window !== 'undefined' && (localStorage.getItem('appLanguage') as AppLanguage)) || 'en';
  }

  t(key: keyof typeof BASE_EN | string, replacements?: { [key: string]: string | number }): string {
    const dict = this.dictionaries[this.currentLang] || this.dictionaries.en;
    let text = (dict as Record<string, string>)[key] || (this.dictionaries.en as Record<string, string>)[key] || key;
    if (replacements) {
      for (const placeholder in replacements) {
        text = text.replace(`{${placeholder}}`, String(replacements[placeholder]));
      }
    }
    return text;
  }

  registerLanguageLoader(lang: string, loader: () => Promise<{ default?: Translations } | Translations>) {
    this.loaders[lang] = loader;
  }

  async loadLanguage(lang: string): Promise<void> {
    if (this.dictionaries[lang as AppLanguage]) return;
    const loader = this.loaders[lang];
    if (!loader) return;
    const pack = await loader();
    const entries = (pack && (pack as any).default) ? (pack as any).default as Translations : (pack as Translations);
    this.dictionaries[lang as AppLanguage] = {
      ...(this.dictionaries[lang as AppLanguage] || {}),
      ...(entries || {}),
    };
  }

  setLanguage(lang: AppLanguage) {
    this.currentLang = lang;
    this.loadLanguage(lang);
    if (typeof window !== 'undefined') {
      localStorage.setItem('appLanguage', lang);
    }
  }

  getLanguage(): AppLanguage {
    return this.currentLang;
  }

  addTranslations(lang: AppLanguage, entries: Translations) {
    Object.assign(this.dictionaries[lang], entries);
  }
}

// Singleton instance
const i18n = new I18n();

// Public API (preserves existing imports)
export function t(key: keyof typeof BASE_EN | string, replacements?: { [key: string]: string | number }): string {
  return i18n.t(key, replacements);
}

export function getKeyAsPageId(key: string): string {
  return key.replace(/([a-z0-9]|(?=[A-Z]))([A-Z])/g, '$1-$2').toLowerCase();
}

export function setLanguage(lang: AppLanguage) {
  i18n.setLanguage(lang);
}

export function getLanguage(): AppLanguage {
  return i18n.getLanguage();
}

export function addTranslations(lang: AppLanguage, entries: Translations) {
  i18n.addTranslations(lang, entries);
}

export function registerLanguageLoader(lang: string, loader: () => Promise<{ default?: Translations } | Translations>) {
  i18n.registerLanguageLoader(lang, loader);
}

export async function loadLanguage(lang: AppLanguage | string): Promise<void> {
  await i18n.loadLanguage(lang as string);
}